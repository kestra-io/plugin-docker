id: docker_compose
namespace: company.team

tasks:
  - id: write_compose
    type: io.kestra.plugin.core.storage.Write
    content: |
      services:
        web:
          image: nginx:alpine
    extension: .yaml

  - id: up
    type: io.kestra.plugin.docker.Compose
    taskRunner:
      type: io.kestra.plugin.scripts.runner.docker.Docker
      volumes:
        - /var/run/docker.sock:/var/run/docker.sock
    composeArgs:
      - up
      - -d
    composeFile: "{{ outputs.write_compose.uri }}"
